import cv2
import mediapipe as mp
import numpy as np

# ✅ כאן אנחנו מייבאים את הקובץ Khabib.py
import Khabib

# Mediapipe Face Mesh
mp_face_mesh = mp.solutions.face_mesh
face_mesh = mp_face_mesh.FaceMesh(static_image_mode=False,
                                  max_num_faces=1,
                                  refine_landmarks=True,
                                  min_detection_confidence=0.5,
                                  min_tracking_confidence=0.5)

# משתמשים בפרמטרים מהקובץ Khabib.py
RED = Khabib.RED
GREEN = Khabib.GREEN
khabib_img = Khabib.khabib_img

def morph_face(frame, landmarks):
    for idx, lm in enumerate(landmarks):
        x, y = int(lm[0]), int(lm[1])
        cv2.circle(frame, (x, y), 1, RED, -1)
    return frame

# הפעלת מצלמה
cap = cv2.VideoCapture(0)

while True:
    ret, frame = cap.read()
    if not ret:
        break
    
    rgb_frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
    results = face_mesh.process(rgb_frame)
    
    if results.multi_face_landmarks:
        face_landmarks = results.multi_face_landmarks[0].landmark
        h, w, _ = frame.shape
        points = [(int(lm.x * w), int(lm.y * h)) for lm in face_landmarks]
        frame = morph_face(frame, points)
    
    cv2.imshow("Khabib Face Morph", frame)
    
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

cap.release()
cv2.destroyAllWindows()
